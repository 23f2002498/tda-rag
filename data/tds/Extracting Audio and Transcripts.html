<article class="markdown-section" id="main"><h2 id="extracting-audio-and-transcripts"><a class="anchor" data-id="extracting-audio-and-transcripts" href="#/extracting-audio-and-transcripts?id=extracting-audio-and-transcripts"><span>Extracting Audio and Transcripts</span></a></h2><h2 id="media-processing-ffmpeg"><a class="anchor" data-id="media-processing-ffmpeg" href="#/extracting-audio-and-transcripts?id=media-processing-ffmpeg"><span>Media Processing: FFmpeg</span></a></h2><p><a href="https://ffmpeg.org/" rel="noopener" target="_blank">FFmpeg</a> is the standard command-line tool for processing video and audio files. It’s essential for data scientists working with media files for:</p><ul><li>Extracting audio/video for machine learning</li><li>Converting formats for web deployment</li><li>Creating visualizations and presentations</li><li>Processing large media datasets</li></ul><p>Basic Operations:</p><pre class="language-bash" data-lang="bash" v-pre=""><code class="lang-bash language-bash"><span class="token comment"># Basic conversion</span>
ffmpeg <span class="token parameter variable">-i</span> input.mp4 output.avi

<span class="token comment"># Extract audio</span>
ffmpeg <span class="token parameter variable">-i</span> input.mp4 <span class="token parameter variable">-vn</span> output.mp3

<span class="token comment"># Convert format without re-encoding</span>
ffmpeg <span class="token parameter variable">-i</span> input.mkv <span class="token parameter variable">-c</span> copy output.mp4

<span class="token comment"># High quality encoding (crf: 0-51, lower is better)</span>
ffmpeg <span class="token parameter variable">-i</span> input.mp4 <span class="token parameter variable">-preset</span> slower <span class="token parameter variable">-crf</span> <span class="token number">18</span> output.mp4</code><button class="docsify-copy-code-button"><span class="label">Copy to clipboard</span><span aria-hidden="hidden" class="error">Error</span><span aria-hidden="hidden" class="success">Copied</span><span aria-live="polite"></span></button></pre><p>Common Data Science Tasks:</p><pre class="language-bash" data-lang="bash" v-pre=""><code class="lang-bash language-bash"><span class="token comment"># Extract frames for computer vision</span>
ffmpeg <span class="token parameter variable">-i</span> input.mp4 <span class="token parameter variable">-vf</span> <span class="token string">"fps=1"</span> frames_%04d.png    <span class="token comment"># 1 frame per second</span>
ffmpeg <span class="token parameter variable">-i</span> input.mp4 <span class="token parameter variable">-vf</span> <span class="token string">"select='eq(n,0)'"</span> <span class="token parameter variable">-vframes</span> <span class="token number">1</span> first_frame.jpg

<span class="token comment"># Create video from image sequence</span>
ffmpeg <span class="token parameter variable">-r</span> <span class="token number">1</span>/5 <span class="token parameter variable">-i</span> img%03d.png <span class="token parameter variable">-c:v</span> libx264 <span class="token parameter variable">-vf</span> <span class="token assign-left variable">fps</span><span class="token operator">=</span><span class="token number">25</span> output.mp4

<span class="token comment"># Extract audio for speech recognition</span>
ffmpeg <span class="token parameter variable">-i</span> input.mp4 <span class="token parameter variable">-ar</span> <span class="token number">16000</span> <span class="token parameter variable">-ac</span> <span class="token number">1</span> audio.wav      <span class="token comment"># 16kHz mono</span>

<span class="token comment"># Trim video/audio for training data</span>
ffmpeg <span class="token parameter variable">-ss</span> 00:01:00 <span class="token parameter variable">-i</span> input.mp4 <span class="token parameter variable">-t</span> 00:00:30 <span class="token parameter variable">-c</span> copy clip.mp4</code><button class="docsify-copy-code-button"><span class="label">Copy to clipboard</span><span aria-hidden="hidden" class="error">Error</span><span aria-hidden="hidden" class="success">Copied</span><span aria-live="polite"></span></button></pre><p>Processing Multiple Files:</p><pre class="language-bash" data-lang="bash" v-pre=""><code class="lang-bash language-bash"><span class="token comment"># Concatenate videos (first create files.txt with list of files)</span>
<span class="token builtin class-name">echo</span> <span class="token string">"file 'input1.mp4'
file 'input2.mp4'"</span> <span class="token operator">&gt;</span> files.txt
ffmpeg <span class="token parameter variable">-f</span> concat <span class="token parameter variable">-i</span> files.txt <span class="token parameter variable">-c</span> copy output.mp4

<span class="token comment"># Batch process with shell loop</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">f</span> <span class="token keyword">in</span> *.mp4<span class="token punctuation">;</span> <span class="token keyword">do</span>
    ffmpeg <span class="token parameter variable">-i</span> <span class="token string">"<span class="token variable">$f</span>"</span> <span class="token parameter variable">-vn</span> <span class="token string">"audio/<span class="token variable">${f<span class="token operator">%</span>.mp4}</span>.wav"</span>
<span class="token keyword">done</span></code><button class="docsify-copy-code-button"><span class="label">Copy to clipboard</span><span aria-hidden="hidden" class="error">Error</span><span aria-hidden="hidden" class="success">Copied</span><span aria-live="polite"></span></button></pre><p>Data Analysis Features:</p><pre class="language-bash" data-lang="bash" v-pre=""><code class="lang-bash language-bash"><span class="token comment"># Get media file information</span>
ffprobe <span class="token parameter variable">-v</span> quiet <span class="token parameter variable">-print_format</span> json <span class="token parameter variable">-show_format</span> <span class="token parameter variable">-show_streams</span> input.mp4

<span class="token comment"># Display frame metadata</span>
ffprobe <span class="token parameter variable">-v</span> quiet <span class="token parameter variable">-print_format</span> json <span class="token parameter variable">-show_frames</span> input.mp4

<span class="token comment"># Generate video thumbnails</span>
ffmpeg <span class="token parameter variable">-i</span> input.mp4 <span class="token parameter variable">-vf</span> <span class="token string">"thumbnail"</span> <span class="token parameter variable">-frames:v</span> <span class="token number">1</span> thumb.jpg</code><button class="docsify-copy-code-button"><span class="label">Copy to clipboard</span><span aria-hidden="hidden" class="error">Error</span><span aria-hidden="hidden" class="success">Copied</span><span aria-live="polite"></span></button></pre><p>Watch this introduction to FFmpeg (12 min):</p><p><a href="https://youtu.be/MPV7JXTWPWI" rel="noopener" target="_blank"><img alt="FFmpeg in 12 Minutes" data-origin="https://i.ytimg.com/vi_webp/MPV7JXTWPWI/sddefault.webp" src="https://i.ytimg.com/vi_webp/MPV7JXTWPWI/sddefault.webp"/></a></p><p>Tools:</p><ul><li><a href="https://ffmpeg.lav.io/" rel="noopener" target="_blank">ffmpeg.lav.io</a>: Interactive command builder</li><li><a href="https://ffmpeg.guide/" rel="noopener" target="_blank">FFmpeg Explorer</a>: Visual FFmpeg command generator</li><li><a href="https://evanhahn.github.io/ffmpeg-buddy/" rel="noopener" target="_blank">FFmpeg Buddy</a>: Simple command generator</li></ul><p>Tips:</p><ol><li>Use <code>-c copy</code> when possible to avoid re-encoding</li><li>Monitor progress with <code>-progress pipe:1</code></li><li>Use <code>-hide_banner</code> to reduce output verbosity</li><li>Test commands with small clips first</li><li>Use hardware acceleration when available (-hwaccel auto)</li></ol><p>Error Handling:</p><pre class="language-bash" data-lang="bash" v-pre=""><code class="lang-bash language-bash"><span class="token comment"># Validate file before processing</span>
ffprobe input.mp4 <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"Invalid"</span>

<span class="token comment"># Continue on errors in batch processing</span>
ffmpeg <span class="token parameter variable">-i</span> input.mp4 output.mp4 <span class="token parameter variable">-xerror</span>

<span class="token comment"># Get detailed error information</span>
ffmpeg <span class="token parameter variable">-v</span> error <span class="token parameter variable">-i</span> input.mp4 <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-A2</span> <span class="token string">"Error"</span></code><button class="docsify-copy-code-button"><span class="label">Copy to clipboard</span><span aria-hidden="hidden" class="error">Error</span><span aria-hidden="hidden" class="success">Copied</span><span aria-live="polite"></span></button></pre><!-- Assessment: Share output of `ffprobe -v quiet -print_format json -show_format {video}` -->
<!-- Assessment: Share output of `ffmpeg -i {video} -vf "select='eq(n,0)'" -vframes 1 {email}.jpg` -->
<h2 id="media-tools-yt-dlp"><a class="anchor" data-id="media-tools-yt-dlp" href="#/extracting-audio-and-transcripts?id=media-tools-yt-dlp"><span>Media tools: yt-dlp</span></a></h2><p><a href="https://github.com/yt-dlp/yt-dlp" rel="noopener" target="_blank">yt-dlp</a> is a feature-rich command-line tool for downloading audio/video from thousands of sites. It’s particularly useful for extracting audio and transcripts from videos.</p><p>Install using your package manager:</p><pre class="language-bash" data-lang="bash" v-pre=""><code class="lang-bash language-bash"><span class="token comment"># macOS</span>
brew <span class="token function">install</span> yt-dlp

<span class="token comment"># Linux</span>
<span class="token function">curl</span> <span class="token parameter variable">-L</span> https://github.com/yt-dlp/yt-dlp/releases/latest/download/yt-dlp <span class="token parameter variable">-o</span> ~/.local/bin/yt-dlp
<span class="token function">chmod</span> a+rx ~/.local/bin/yt-dlp

<span class="token comment"># Windows</span>
winget <span class="token function">install</span> yt-dlp</code><button class="docsify-copy-code-button"><span class="label">Copy to clipboard</span><span aria-hidden="hidden" class="error">Error</span><span aria-hidden="hidden" class="success">Copied</span><span aria-live="polite"></span></button></pre><p>Common operations for extracting audio and transcripts:</p><pre class="language-bash" data-lang="bash" v-pre=""><code class="lang-bash language-bash"><span class="token comment"># Download audio only at lowest quality suitable for speech</span>
yt-dlp <span class="token parameter variable">-f</span> <span class="token string">"ba[abr&lt;50]/worstaudio"</span> <span class="token punctuation">\</span>
       --extract-audio <span class="token punctuation">\</span>
       --audio-format mp3 <span class="token punctuation">\</span>
       --audio-quality 32k <span class="token punctuation">\</span>
       <span class="token string">"https://www.youtube.com/watch?v=VIDEO_ID"</span>

<span class="token comment"># Download auto-generated subtitles</span>
yt-dlp --write-auto-sub <span class="token punctuation">\</span>
       --skip-download <span class="token punctuation">\</span>
       --sub-format <span class="token string">"srt"</span> <span class="token punctuation">\</span>
       <span class="token string">"https://www.youtube.com/watch?v=VIDEO_ID"</span>

<span class="token comment"># Download both audio and subtitles with custom output template</span>
yt-dlp <span class="token parameter variable">-f</span> <span class="token string">"ba[abr&lt;50]/worstaudio"</span> <span class="token punctuation">\</span>
       --extract-audio <span class="token punctuation">\</span>
       --audio-format mp3 <span class="token punctuation">\</span>
       --audio-quality 32k <span class="token punctuation">\</span>
       --write-auto-sub <span class="token punctuation">\</span>
       --sub-format <span class="token string">"srt"</span> <span class="token punctuation">\</span>
       <span class="token parameter variable">-o</span> <span class="token string">"%(title)s.%(ext)s"</span> <span class="token punctuation">\</span>
       <span class="token string">"https://www.youtube.com/watch?v=VIDEO_ID"</span>

<span class="token comment"># Download entire playlist's audio</span>
yt-dlp <span class="token parameter variable">-f</span> <span class="token string">"ba[abr&lt;50]/worstaudio"</span> <span class="token punctuation">\</span>
       --extract-audio <span class="token punctuation">\</span>
       --audio-format mp3 <span class="token punctuation">\</span>
       --audio-quality 32k <span class="token punctuation">\</span>
       <span class="token parameter variable">-o</span> <span class="token string">"%(playlist_index)s-%(title)s.%(ext)s"</span> <span class="token punctuation">\</span>
       <span class="token string">"https://www.youtube.com/playlist?list=PLAYLIST_ID"</span></code><button class="docsify-copy-code-button"><span class="label">Copy to clipboard</span><span aria-hidden="hidden" class="error">Error</span><span aria-hidden="hidden" class="success">Copied</span><span aria-live="polite"></span></button></pre><p>For Python integration:</p><pre class="language-python" data-lang="python" v-pre=""><code class="lang-python language-python"><span class="token comment"># /// script</span>
<span class="token comment"># requires-python = "&gt;=3.9"</span>
<span class="token comment"># dependencies = ["yt-dlp"]</span>
<span class="token comment"># ///</span>

<span class="token keyword">import</span> yt_dlp

<span class="token keyword">def</span> <span class="token function">download_audio</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Download audio at speech-optimized quality."""</span>
    ydl_opts <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'format'</span><span class="token punctuation">:</span> <span class="token string">'ba[abr&lt;50]/worstaudio'</span><span class="token punctuation">,</span>
        <span class="token string">'postprocessors'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
            <span class="token string">'key'</span><span class="token punctuation">:</span> <span class="token string">'FFmpegExtractAudio'</span><span class="token punctuation">,</span>
            <span class="token string">'preferredcodec'</span><span class="token punctuation">:</span> <span class="token string">'mp3'</span><span class="token punctuation">,</span>
            <span class="token string">'preferredquality'</span><span class="token punctuation">:</span> <span class="token string">'32'</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">with</span> yt_dlp<span class="token punctuation">.</span>YoutubeDL<span class="token punctuation">(</span>ydl_opts<span class="token punctuation">)</span> <span class="token keyword">as</span> ydl<span class="token punctuation">:</span>
        ydl<span class="token punctuation">.</span>download<span class="token punctuation">(</span><span class="token punctuation">[</span>url<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># Example usage</span>
download_audio<span class="token punctuation">(</span><span class="token string">'https://www.youtube.com/watch?v=VIDEO_ID'</span><span class="token punctuation">)</span></code><button class="docsify-copy-code-button"><span class="label">Copy to clipboard</span><span aria-hidden="hidden" class="error">Error</span><span aria-hidden="hidden" class="success">Copied</span><span aria-live="polite"></span></button></pre><p>Tools:</p><ul><li><a href="https://ffmpeg.org/" rel="noopener" target="_blank">ffmpeg</a>: Required for audio extraction and conversion</li><li><a href="https://github.com/openai/whisper" rel="noopener" target="_blank">whisper</a>: Can be used with yt-dlp for speech-to-text</li><li><a href="https://github.com/mikf/gallery-dl" rel="noopener" target="_blank">gallery-dl</a>: Alternative for image-focused sites</li></ul><p>Note: Always respect copyright and terms of service when downloading content.</p><h2 id="whisper-transcription"><a class="anchor" data-id="whisper-transcription" href="#/extracting-audio-and-transcripts?id=whisper-transcription"><span>Whisper transcription</span></a></h2><p><a href="https://github.com/SYSTRAN/faster-whisper" rel="noopener" target="_blank">Faster Whisper</a> is a highly optimized implementation of OpenAI’s <a href="https://github.com/openai/whisper" rel="noopener" target="_blank">Whisper model</a>, offering up to 4x faster transcription while using less memory.</p><p>You can install it via:</p><ul><li><code>pip install faster-whisper</code></li><li><a href="https://github.com/Purfview/whisper-standalone-win/releases" rel="noopener" target="_blank">Download Windows Standalone</a></li></ul><p>Here’s a basic usage example:</p><pre class="language-bash" data-lang="bash" v-pre=""><code class="lang-bash language-bash">faster-whisper-xxl <span class="token string">"video.mp4"</span> <span class="token parameter variable">--model</span> medium <span class="token parameter variable">--language</span> en</code><button class="docsify-copy-code-button"><span class="label">Copy to clipboard</span><span aria-hidden="hidden" class="error">Error</span><span aria-hidden="hidden" class="success">Copied</span><span aria-live="polite"></span></button></pre><p>Here’s my recommendation for transcribing videos. This saves the output in JSON as well as SRT format in the source directory.</p><pre class="language-bash" data-lang="bash" v-pre=""><code class="lang-bash language-bash">faster-whisper-xxl <span class="token parameter variable">--print_progress</span> <span class="token parameter variable">--output_dir</span> <span class="token builtin class-name">source</span> <span class="token parameter variable">--batch_recursive</span> <span class="token punctuation">\</span>
                   <span class="token parameter variable">--check_files</span> <span class="token parameter variable">--standard</span> <span class="token parameter variable">--output_format</span> json srt <span class="token punctuation">\</span>
                   <span class="token parameter variable">--model</span> medium <span class="token parameter variable">--language</span> en <span class="token variable">$FILE</span></code><button class="docsify-copy-code-button"><span class="label">Copy to clipboard</span><span aria-hidden="hidden" class="error">Error</span><span aria-hidden="hidden" class="success">Copied</span><span aria-live="polite"></span></button></pre><ul><li><code>--model</code>: The OpenAI Whisper model to use. You can choose from:<ul><li><code>tiny</code>: Fastest but least accurate</li><li><code>base</code>: Good for simple audio</li><li><code>small</code>: Balanced speed/accuracy</li><li><code>medium</code>: Recommended default</li><li><code>large-v3</code>: Most accurate but slowest</li></ul></li><li><code>--output_format</code>: The output format to use. You can pick multiple formats from:<ul><li><code>json</code>: Has the most detailed information including timing, text, quality, etc.</li><li><code>srt</code>: A popular subtitle format. You can use this in YouTube, for example.</li><li><code>vtt</code>: A modern subtitle format.</li><li><code>txt</code>: Just the text transcript</li></ul></li><li><code>--output_dir</code>: The directory to save the output files. <code>source</code> indicates the source directory, i.e. where the input <code>$FILE</code> is</li><li><code>--language</code>: The language of the input file. If you don’t specify it, it analyzes the first 30 seconds to auto-detect. You can speed it up by specifying it.</li></ul><p>Run <code>faster-whisper-xxl --help</code> for more options.</p><h2 id="gemini-transcription"><a class="anchor" data-id="gemini-transcription" href="#/extracting-audio-and-transcripts?id=gemini-transcription"><span>Gemini transcription</span></a></h2><p>The <a href="https://gemini.google.com/" rel="noopener" target="_blank">Gemini</a> models from Google are notable in two ways:</p><ol><li>They have a <em>huge</em> input context window. Gemini 2.0 Flash can accept 1M tokens, for example.</li><li>They can handle audio input.</li></ol><p>This allows us to use Gemini to transcribe audio files.</p><p>LLMs are not good at transcribing audio <em>faithfully</em>. They tend to correct errors and meander from what was said. But they are intelligent. That enables a few powerful workflows. Here are some examples:</p><ol><li><strong>Transcribe into other languages</strong>. Gemini will handle the transcription and translation in a single step.</li><li><strong>Summarize audio transcripts</strong>. For example, convert a podcast into a tutorial, or a meeting recording into actions.</li><li><strong>Legal Proceeding Analysis</strong>. Extract case citations, dates, and other details from a legal debate.</li><li><strong>Medical Consultation Summary</strong>. Extract treatments, medications, details of next visit, etc. from a medical consultation.</li></ol><p>Here’s how to use Gemini to transcribe audio files.</p><ol><li>Get a <a href="https://aistudio.google.com/app/apikey" rel="noopener" target="_blank">Gemini API key</a> from Google AI Studio.</li><li>Set the <code>GEMINI_API_KEY</code> environment variable to the API key.</li><li>Set the <code>MP3_FILE</code> environment variable to the path of the MP3 file you want to transcribe.</li><li>Run this code:<pre class="language-bash" data-lang="bash" v-pre=""><code class="lang-bash language-bash"><span class="token function">curl</span> <span class="token parameter variable">-X</span> POST https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-002:streamGenerateContent?alt<span class="token operator">=</span>sse <span class="token punctuation">\</span>
  <span class="token parameter variable">-H</span> <span class="token string">"X-Goog-API-Key: <span class="token variable">$GEMINI_API_KEY</span>"</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-H</span> <span class="token string">"Content-Type: application/json"</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-d</span> <span class="token string">"$(cat &lt;&lt; EOF
{
  "contents": [
    {
      "role": "user",
      "parts": [
        {
          "inline_data": {
            "mime_type": "audio/mp3",
            "data": "<span class="token variable"><span class="token variable">$(</span>base64 <span class="token parameter variable">--wrap</span><span class="token operator">=</span><span class="token number">0</span> $MP3_FILE<span class="token variable">)</span></span>"</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>,
        <span class="token punctuation">{</span><span class="token string">"text"</span><span class="token builtin class-name">:</span> <span class="token string">"Transcribe this"</span><span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
EOF
<span class="token punctuation">)</span>"</code><button class="docsify-copy-code-button"><span class="label">Copy to clipboard</span><span aria-hidden="hidden" class="error">Error</span><span aria-hidden="hidden" class="success">Copied</span><span aria-live="polite"></span></button></pre></li></ol><div class="docsify-pagination-container">
<div class="pagination-item pagination-item--previous">
<a href="#/transforming-images">
<div class="pagination-item-label">
<svg height="16" viewbox="0 0 10 16" width="10" xmlns="http://www.w3.org/2000/svg">
<polyline fill="none" points="8,2 2,8 8,14" vector-effect="non-scaling-stroke"></polyline>
</svg>
<span>Previous</span>
</div>
<div class="pagination-item-title">Transforming Images</div>
<div class="pagination-item-subtitle"></div></a>
</div>
<div class="pagination-item pagination-item--next">
<a href="#/data-analysis">
<div class="pagination-item-label">
<span>Next</span>
<svg height="16" viewbox="0 0 10 16" width="10" xmlns="http://www.w3.org/2000/svg">
<polyline fill="none" points="2,2 8,8 2,14" vector-effect="non-scaling-stroke"></polyline>
</svg>
</div>
<div class="pagination-item-title">6. Data Analysis</div>
<div class="pagination-item-subtitle"></div></a>
</div>
</div></article>