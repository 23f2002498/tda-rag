<article class="markdown-section" id="main"><h2 id="function-calling-with-openai"><a class="anchor" data-id="function-calling-with-openai" href="#/function-calling?id=function-calling-with-openai"><span>Function Calling with OpenAI</span></a></h2><p><a href="https://platform.openai.com/docs/guides/function-calling" rel="noopener" target="_blank">Function Calling</a> allows Large Language Models to convert natural language into structured function calls. This is perfect for building chatbots and AI assistants that need to interact with your backend systems.</p><p>OpenAI supports <a href="https://platform.openai.com/docs/guides/function-calling" rel="noopener" target="_blank">Function Calling</a> – a way for LLMs to suggest what functions to call and how.</p><p><a href="https://youtu.be/aqdWSYWC_LI" rel="noopener" target="_blank"><img alt="OpenAI Function Calling - Full Beginner Tutorial" data-origin="https://i.ytimg.com/vi_webp/aqdWSYWC_LI/sddefault.webp" src="https://i.ytimg.com/vi_webp/aqdWSYWC_LI/sddefault.webp"/></a></p><p>Here’s a minimal example using Python and OpenAI’s function calling that identifies the weather in a given location.</p><pre class="language-python" data-lang="python" v-pre=""><code class="lang-python language-python"><span class="token comment"># /// script</span>
<span class="token comment"># requires-python = "&gt;=3.11"</span>
<span class="token comment"># dependencies = [</span>
<span class="token comment">#   "httpx",</span>
<span class="token comment"># ]</span>
<span class="token comment"># ///</span>

<span class="token keyword">import</span> httpx
<span class="token keyword">import</span> os
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Dict<span class="token punctuation">,</span> Any


<span class="token keyword">def</span> <span class="token function">query_gpt</span><span class="token punctuation">(</span>user_input<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> tools<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">[</span>Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
    response <span class="token operator">=</span> httpx<span class="token punctuation">.</span>post<span class="token punctuation">(</span>
        <span class="token string">"https://api.openai.com/v1/chat/completions"</span><span class="token punctuation">,</span>
        headers<span class="token operator">=</span><span class="token punctuation">{</span>
            <span class="token string">"Authorization"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"Bearer </span><span class="token interpolation"><span class="token punctuation">{</span>os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">'OPENAI_API_KEY'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
            <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        json<span class="token operator">=</span><span class="token punctuation">{</span>
            <span class="token string">"model"</span><span class="token punctuation">:</span> <span class="token string">"gpt-4o-mini"</span><span class="token punctuation">,</span>
            <span class="token string">"messages"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> user_input<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"tools"</span><span class="token punctuation">:</span> tools<span class="token punctuation">,</span>
            <span class="token string">"tool_choice"</span><span class="token punctuation">:</span> <span class="token string">"auto"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"choices"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"message"</span><span class="token punctuation">]</span>


WEATHER_TOOL <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"function"</span><span class="token punctuation">,</span>
    <span class="token string">"function"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"get_weather"</span><span class="token punctuation">,</span>
        <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"Get the current weather for a location"</span><span class="token punctuation">,</span>
        <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"object"</span><span class="token punctuation">,</span>
            <span class="token string">"properties"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"location"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span> <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"City name or coordinates"</span><span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">"required"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"location"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"additionalProperties"</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"strict"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    response <span class="token operator">=</span> query_gpt<span class="token punctuation">(</span><span class="token string">"What is the weather in San Francisco?"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>WEATHER_TOOL<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">[</span>tool_call<span class="token punctuation">[</span><span class="token string">"function"</span><span class="token punctuation">]</span> <span class="token keyword">for</span> tool_call <span class="token keyword">in</span> response<span class="token punctuation">[</span><span class="token string">"tool_calls"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code><button class="docsify-copy-code-button"><span class="label">Copy to clipboard</span><span aria-hidden="hidden" class="error">Error</span><span aria-hidden="hidden" class="success">Copied</span><span aria-live="polite"></span></button></pre><h3 id="how-to-define-functions"><a class="anchor" data-id="how-to-define-functions" href="#/function-calling?id=how-to-define-functions"><span>How to define functions</span></a></h3><p>The function definition is a <a href="https://json-schema.org/" rel="noopener" target="_blank">JSON schema</a> with a few OpenAI specific properties.
See the <a href="https://platform.openai.com/docs/guides/structured-outputs#supported-schemas" rel="noopener" target="_blank">Supported schemas</a>.</p><p>Here’s an example of a function definition for scheduling a meeting:</p><pre class="language-python" data-lang="python" v-pre=""><code class="lang-python language-python">MEETING_TOOL <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"function"</span><span class="token punctuation">,</span>
    <span class="token string">"function"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"schedule_meeting"</span><span class="token punctuation">,</span>
        <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"Schedule a meeting room for a specific date and time"</span><span class="token punctuation">,</span>
        <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"object"</span><span class="token punctuation">,</span>
            <span class="token string">"properties"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"date"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>
                    <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"Meeting date in YYYY-MM-DD format"</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token string">"time"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>
                    <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"Meeting time in HH:MM format"</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token string">"meeting_room"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>
                    <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"Name of the meeting room"</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">"required"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"date"</span><span class="token punctuation">,</span> <span class="token string">"time"</span><span class="token punctuation">,</span> <span class="token string">"meeting_room"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"additionalProperties"</span><span class="token punctuation">:</span> <span class="token boolean">False</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"strict"</span><span class="token punctuation">:</span> <span class="token boolean">True</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><button class="docsify-copy-code-button"><span class="label">Copy to clipboard</span><span aria-hidden="hidden" class="error">Error</span><span aria-hidden="hidden" class="success">Copied</span><span aria-live="polite"></span></button></pre><h3 id="how-to-define-multiple-functions"><a class="anchor" data-id="how-to-define-multiple-functions" href="#/function-calling?id=how-to-define-multiple-functions"><span>How to define multiple functions</span></a></h3><p>You can define multiple functions by passing a list of function definitions to the <code>tools</code> parameter.</p><p>Here’s an example of a list of function definitions for handling employee expenses and calculating performance bonuses:</p><pre class="language-python" data-lang="python" v-pre=""><code class="lang-python language-python">tools <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"function"</span><span class="token punctuation">,</span>
        <span class="token string">"function"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"get_expense_balance"</span><span class="token punctuation">,</span>
            <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"Get expense balance for an employee"</span><span class="token punctuation">,</span>
            <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"object"</span><span class="token punctuation">,</span>
                <span class="token string">"properties"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token string">"employee_id"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"integer"</span><span class="token punctuation">,</span>
                        <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"Employee ID number"</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token string">"required"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"employee_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">"additionalProperties"</span><span class="token punctuation">:</span> <span class="token boolean">False</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">"strict"</span><span class="token punctuation">:</span> <span class="token boolean">True</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"function"</span><span class="token punctuation">,</span>
        <span class="token string">"function"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"calculate_performance_bonus"</span><span class="token punctuation">,</span>
            <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"Calculate yearly performance bonus for an employee"</span><span class="token punctuation">,</span>
            <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"object"</span><span class="token punctuation">,</span>
                <span class="token string">"properties"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token string">"employee_id"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"integer"</span><span class="token punctuation">,</span>
                        <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"Employee ID number"</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token string">"current_year"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"integer"</span><span class="token punctuation">,</span>
                        <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"Year to calculate bonus for"</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token string">"required"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"employee_id"</span><span class="token punctuation">,</span> <span class="token string">"current_year"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">"additionalProperties"</span><span class="token punctuation">:</span> <span class="token boolean">False</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">"strict"</span><span class="token punctuation">:</span> <span class="token boolean">True</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span></code><button class="docsify-copy-code-button"><span class="label">Copy to clipboard</span><span aria-hidden="hidden" class="error">Error</span><span aria-hidden="hidden" class="success">Copied</span><span aria-live="polite"></span></button></pre><p>Best Practices:</p><ol><li><strong>Use Strict Mode</strong><ul><li>Always set <code>strict: True</code> to ensure valid function calls</li><li>Define all required parameters</li><li>Set <code>additionalProperties: False</code></li></ul></li><li><strong>Use tool choice</strong><ul><li>Set <code>tool_choice: "required"</code> to ensure that the model will always call one or more tools</li><li>The default is <code>tool_choice: "auto"</code> which means the model will choose a tool only if appropriate</li></ul></li><li><strong>Clear Descriptions</strong><ul><li>Write detailed function and parameter descriptions</li><li>Include expected formats and units</li><li>Mention any constraints or limitations</li></ul></li><li><strong>Error Handling</strong><ul><li>Validate function inputs before execution</li><li>Return clear error messages</li><li>Handle missing or invalid parameters</li></ul></li></ol><div class="docsify-pagination-container">
<div class="pagination-item pagination-item--previous">
<a href="#/hybrid-rag-typesense">
<div class="pagination-item-label">
<svg height="16" viewbox="0 0 10 16" width="10" xmlns="http://www.w3.org/2000/svg">
<polyline fill="none" points="8,2 2,8 8,14" vector-effect="non-scaling-stroke"></polyline>
</svg>
<span>Previous</span>
</div>
<div class="pagination-item-title">Hybrid RAG with TypeSense</div>
<div class="pagination-item-subtitle"></div></a>
</div>
<div class="pagination-item pagination-item--next">
<a href="#/llm-agents">
<div class="pagination-item-label">
<span>Next</span>
<svg height="16" viewbox="0 0 10 16" width="10" xmlns="http://www.w3.org/2000/svg">
<polyline fill="none" points="2,2 8,8 2,14" vector-effect="non-scaling-stroke"></polyline>
</svg>
</div>
<div class="pagination-item-title">LLM Agents</div>
<div class="pagination-item-subtitle"></div></a>
</div>
</div></article>